

    

<main class="container bg-light mt-5">



<!--Top messages bar- search, filters, and new message button  -->

<div class="container bg-light  ">
    
          <!-- new message button -->
          <div class="row">
  
              <button type="button" class="btn btn-outline-primary col-sm-1 m-auto  " data-toggle="modal" data-target="#NewMessageModal">
                  <i class="fas fa-plus "></i>  <span class="m-auto p-auto">Message</span>
              </button>
            
          <!-- search bar  -->
              <div class="col-sm-7 m-0 p-1">  
                  <input class=" col-12" type="text" placeholder="Search.." id="search" ng-model="searchStr">              
              </div>
            
              <!-- filter by priority -->
              <div class="form-group col-sm-1 ml-0 p-0">
                  
                  <select class="form-control" id="sel1" ng-model="priorityFilter">
                    <option>Low</option>
                    <option>Medium</option>
                    <option>High</option>
                    <option>Critical</option>
                  </select>
                </div>
    
            <!-- sort by  -->
    
            <div class="dropdown col-sm-1 ml-0 p-0 ">
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" ng-click="sortParam=''">All</button>
                    <button type="button" class="btn btn-secondary" ng-click="sortParam=createdAt">Date</button>
                </div>
          </div> 
        </div>      
  </div>    
    
  <hr>  


<!-- All and Critical button navigators  -->

<!-- Nav tabs -->
<ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link active" data-toggle="tab" href="#!/messages" ng-click="priorityFilter='' ">All</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-toggle="tab" href="#!/messages" ng-click="priorityFilter='Critical' ">Critical</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-toggle="tab" href="#!/messages" ng-click="priorityFilter='High' ">High</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#!/messages" ng-click="priorityFilter='Medium' ">Medium</a>
      </li>
      <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#!/messages" ng-click="priorityFilter='Low' ">Low</a>
      </li>  
  </ul>
  
  <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane active container" id="home">...</div>
    <div class="tab-pane container" id="menu1">...</div>
    <div class="tab-pane container" id="menu2">...</div>
  </div>



<!-- messages Display Area -->

<div class="bg-light">
   
    
    <div id="accordion">

      <div class="card" ng-repeat="message in messages | filter: searchStr |filter: {priority: priorityFilter} | orderBy: sortParam ">
        <div class="card-header " id="headingOne" data-toggle="collapse" data-target="#{{$index}}">

            <div class="row">   

              <!-- Author photo -->
              <div class="col-sm-1">
                <img style="width:50px;" src="assets/manTenant.png">
                <div ng-repeat="user in message.createdBy" ng-show="userImg(user)">
                  <img src="{{authorPhoto}}">
                </div>
              </div>    
              <!-- Author name -->
              <div class="my-auto col-sm-2">
                 <div ng-repeat="user in message.createdBy">{{user.fname}} {{user.lname }} </div>                       
              </div>    
              
              <!-- messages title -->
              <h5 class="my-auto col-sm-6">
                <button class="btn btn-link" data-toggle="collapse" data-target="#{{$index}}" aria-expanded="false" aria-controls="{{$index}}">
                  {{message.title}}
                </button>
              </h5>
              
              
              
              <!-- creation date and time -->
              <div class="col-sm-2 ml-auto">
                  <!-- Creation Date -->
                  <div>
                    <p>{{message.createdAt|date:'dd/MM/yyyy'}}</p>
                  </div>
                  <!-- creation hour -->
                  <div>
                    <p>{{message.createdAt|date:'HH:mm:ss'}}</p>
                  </div>
              </div>    

              <!-- priority icon -->
              <div class="border p-auto m-auto">
                  <i ng-show="message.priority=='High' || message.priority=='Medium' || message.priority=='Low' " class="text-primary fas fa-info fa-2x" ></i>
                  <i ng-show="message.priority=='Critical' " class="text-danger fas fa-exclamation fa-2x"></i>
              </div>

            </div>  
          
        </div>
    
         <!--message Body  -->

        <div id="{{$index}}" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
          <div class="card-body row">
            <!-- message text (details) -->
            <div class="col-sm-6">
                <h6>Message Details</h6>
                <p>{{message.details}}</p>
                <p>Priority:{{message.priority}}</p>
            </div>
            <!-- message comments section -->
            <div class="col-sm-6">
                <h6>Comments</h6>
                <div >
                    <div class="border m-1" ng-repeat="comment in message.comments">                    
                      <h6>{{comment.createdBy}} <time>{{message.createdAt}}</time></h6>                  
                      <p>{{comment.text}}</p>
                    </div>
                </div>
                <input type="text" ng-model="text"><button type="btn" class="btn btn primary" ng-click="comment($index,text)">Comment</button>
            </div>

             <!-- delete and update buttons  -->
             <div class="float-right">
                <button type="btn" class="btn btn-primary" ng-click="delete(message)">Delete</button>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#updateModal" ng-click="">Update</button>
              </div>
            
          </div>
        </div>
        
        
      </div>
      
    </div>


  </div>


</main>




<!-- modal screens  -->

  <!--New message modal dialog -->


  
  <!-- The Modal -->
  <div class="modal fade" id="NewMessageModal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">New Message</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
          
            <form class="message container bg-light">
                
                  <div class="form-group">
                          <label for="messageTitle">Message Title</label>
                          <input type="text" class="form-control" id="messageTitle" ng-model="message.title">
                  </div>
      
                  <div class="form-group">
                          <label for="messageDetails">Message Details</label>
                          <textarea class="form-control" rows="5" id="messageDetails" ng-model="message.details"></textarea>
                  </div>
                  
                  <div class="form-group">
                          <label for="sel1">Priority:</label>
                          <select class="form-control" id="sel1" ng-model="message.priority">
                            <option>Low</option>
                            <option>Medium</option>
                            <option>High</option>
                            <option>Critical</option>
                          </select>
                  </div> 
      
                  <div>
                          <time>Created At: X</time>
                  </div>
      
                  <div>
                          <time>Created By: Current user(x)</time>
                  </div>
                  
                  
      
                        
              </form>


        </div>

            
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-default" data-dismiss="modal" ng-click="msgSubmit(message)">Submit</button>
        </div>
  
      </div>
    </div>
  </div>  






   <!-- update message dialog  -->


  <!-- The Modal -->
  <div class="modal fade" id="updateModal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Update Message (should be fixed)</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
          
            <form class="message container bg-light">
                
                  <div class="form-group">
                          <label for="messageTitle">Message Title</label>
                          <input type="text" class="form-control" id="messageTitle" ng-model="message.title" >
                  </div>
      
                  <div class="form-group">
                          <label for="messageDetails">Message Details</label>
                          <textarea class="form-control" rows="5" id="messageDetails" ng-model="message.details"></textarea>
                  </div>
                  
                  <div class="form-group">
                          <label for="sel1">Priority:</label>
                          <select class="form-control" id="sel1" ng-model="message.priority">  
                            <option>Low</option>
                            <option>Medium</option>
                            <option>High</option>
                            <option>Critical</option>
                          </select>
                  </div> 
      
                  <div>
                          <time>Created At: X</time>
                  </div>
      
                  <div>
                          <time>Created By: Current user(x)</time>
                  </div>
                  
                  
      
                        
              </form>


        </div>
  
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-default" data-dismiss="modal" ng-click="update(message)">Update</button>
        </div>
  
      </div>
    </div>
  </div>  
  

  
  
 